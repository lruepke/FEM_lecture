


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Example 1: Cooling dike &mdash; Finite Element Modeling in Geodynamics  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/tabs.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="References" href="../refs.html" />
    <link rel="prev" title="Introduction Finite Differences" href="fdm_intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Finite Element Modeling in Geodynamics
          

          
            
            <img src="../_static/htf_picto2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Course information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general-info/course-details.html">Course details</a></li>
</ul>
<p class="caption"><span class="caption-text">Lecture 1</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Lecture overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdm_intro.html">Introduction Finite Differences</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example 1: Cooling dike</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="mailto:lruepke@geomar.de"><i class="fa fa-envelope fa-fw"></i> Prof. Lars Ruepke</a></li>
            
                <li class="toctree-l1"><a href="mailto:zguo@geomar.de"><i class="fa fa-envelope fa-fw"></i> Dr. Zhikui Guo</a></li>
            
                <li class="toctree-l1"><a href="https://lruepke.github.io/FEM_lecture/"><i class="fa fa-home fa-fw"></i> Public site</a></li>
            
                <li class="toctree-l1"><a href="https://lms.uni-kiel.de/url/RepositoryEntry/3664576582"><i class="fa fa-home fa-fw"></i> University site</a></li>
            
        </ul>
    

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Finite Element Modeling in Geodynamics</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Example 1: Cooling dike</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/lruepke/HTF_lecture/blob/main//source/lecture1/cooling_dike.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="example-1-cooling-dike">
<h1>Example 1: Cooling dike<a class="headerlink" href="#example-1-cooling-dike" title="Permalink to this headline">¶</a></h1>
<p>As a first example, we will use the finite differences form of the heat diffusion equation <a class="reference internal" href="fdm_intro.html#equation-eq-1d-heat-flow">equation (2)</a> to explore the cooling of a dike. We will look at a  <span class="math notranslate nohighlight">\(2m\)</span> wide dike that intruded with a temperature of  <span class="math notranslate nohighlight">\(1200°C\)</span> into  <span class="math notranslate nohighlight">\(300°C\)</span> warm country rock. The initial conditions can then be written like this:</p>
<div class="math notranslate nohighlight" id="equation-eq-dike-ic">
<span class="eqno">(12)<a class="headerlink" href="#equation-eq-dike-ic" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{align}
\begin{split}
T(x&lt;-1 \mid x&gt;1) = 300\\
T(x&gt;-1 \&amp; x&lt;1) = 1200
\end{split}
\end{align}\end{split}\]</div>
<p>In addition, we assume that the temperature far away from the dike center (at <span class="math notranslate nohighlight">\(\lvert L/2 \rvert\)</span>) remains at a constant temperature. The boundary conditions are thus:</p>
<div class="math notranslate nohighlight" id="equation-eq-dike-bc">
<span class="eqno">(13)<a class="headerlink" href="#equation-eq-dike-bc" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{align}
\begin{split}
T(x=-\frac{L}{2}) = 300\\
T(x=\frac{L}{2}) = 300
\end{split}
\end{align}\end{split}\]</div>
<p>Figure ref{fig:dike_setup} summarized the setup of the cooling dike problem:</p>
<dl class="simple">
<dt>begin{figure}[htb]</dt><dd><p>center{includegraphics[width=textwidth]{figures/1D_dike_example_stencil.png}}</p>
</dd>
<dt>%       vspace{3in}</dt><dd><p>caption{label{fig:dike_setup} A) Setup of the model considered here. A hot basaltic dike intrudes into colder country rock. Only variations in x-direction are considered; properties in the other directions are assumed to be constant. The initial temperature distribution $T(x,0)$ has a step-like perturbation. B) Finite difference discretization of the 1D heat equation. The finite difference method approximates the temperature at given grid points, with spacing $Delta x$. The time-evolution is also computed at given times with timestep $Delta t$.
}</p>
</dd>
</dl>
<p>end{figure}</p>
<p>subsection{Exercises}</p>
<dl class="simple">
<dt>begin{enumerate}</dt><dd><p>item Open MATLAB and an editor and type the Matlab script in an empty file. Save the file under the name ”heat1Dexplicit.m”. Fill in the question marks and run the file by typing heat1Dexplicit in the MATLAB command window (make sure you’re in the correct directory).
item Vary the parameters (e.g. use more gridpoints, a larger timestep). Note that if the timestep is increased beyond a certain value (what does this value depend on?), the numerical method becomes unstable. This is a major drawback of explicit finite difference codes such as the one presented here. In the next lesson we will learn methods that do not have these limitations.
item Go through the rest of the handout and see how one derives finite difference approximations.
item Record and plot the temperature evolution versus time at a distance of $5 unt{m}$ from the dike/country rock contact. What is the maximum temperature the country rock experiences at this location and when is it reached?
Bonus question: Derive a finite-difference approximation for variable $k$ and variable $Delta x$.</p>
</dd>
</dl>
<p>end{enumerate}
pagebreak</p>
<p>lstset{language=Matlab, frame=single, basicstyle=footnotesize} %or small or footnotesize etc.}
begin{lstlisting}
%heat1Dexplicit.m
%
% Solves the 1D heat equation with an explicit finite difference scheme
clear</p>
<p>%Physical parameters
L       = 100;                          % Length of modeled domain [m]
Tmagma  = 1200;                         % Temperature of magma [C]
Trock   = 300;                          % Temperature of country rock [C]
kappa   = 1e-6;                         % Thermal diffusivity of rock [m2/s]
W       = 5;                            % Width of dike [m]
day     = 3600*24;                      % # seconds per day
dt      = 1*day;                        % Timestep [s]</p>
<p>% Numerical parameters
nx      = 201;                          % Number of gridpoints in x-direction
nt      = 500;                          % Number of timesteps to compute
dx      = L/(nx-1);                     % Spacing of grid
X       = linspace(-L/2,L/2,nx);        % Grid</p>
<p>% Setup initial temperature profile
T       = ones(nx)*Trock;
T(abs(X)&lt;=W/2) = Tmagma;
time    = 0;</p>
<p>%Main time loop
for n=1:nt % Timestep loop</p>
<blockquote>
<div><p>% Compute new temperature
Tnew = zeros(1,nx);
for i=2:nx-1</p>
<blockquote>
<div><p>Tnew(i) = T(i) + ?????;</p>
</div></blockquote>
<p>end</p>
<p>% Set boundary conditions
Tnew(1)     = T(1);
Tnew(nx)    = T(nx);</p>
<p>% Update temperature and time
T           = Tnew;
time        = time+dt;</p>
<p>% Plot solution
figure(1), clf
plot(X,Tnew);
xlabel(‘x [m]’)
ylabel(‘Temperature [^circ C]’)
title([‘Temperature evolution after ‘,num2str(time/day),’ days’])
drawnow</p>
</div></blockquote>
<p>end
end{lstlisting}</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../refs.html" class="btn btn-neutral float-right" title="References" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="fdm_intro.html" class="btn btn-neutral float-left" title="Introduction Finite Differences" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Lars Ruepke and Zhikui Guo.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
      
        <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
          <span class="rst-current-version" data-toggle="rst-current-version">
            <span class="fa fa-book"> Finite Element Modeling in Geodynamics</span>
            v: latest
            <span class="fa fa-caret-down"></span>
          </span>
          <div class="rst-other-versions">
            <dl>
              
                
                <dd><a href="https://lruepke.github.io/FEM_lecture/downloads/LectureNote.pdf">latest</a></dd>
                
                <dd><a href="#/LectureNote.pdf">2.0</a></dd>
                
              
          </div>
        </div>
      
    

</body>
</html>